from genekey import indexer
import pytest


def test_one_line_file(fixture_hamlet_info):
    index = indexer.FileIndexer(fixture_hamlet_info)
    index.read()

    assert index.get_index() == {
        'ha': 3, 'ml': 3, 'am': 2, 'le': 2, 'et': 2, 't.': 2, 'ed': 2, 'ht': 2,
        '`h': 1, '.t': 1, 'tx': 1, 'xt': 1, 't`': 1, '` ': 1, ' c': 1, 'co': 1,
        'op': 1, 'pi': 1, 'ie': 1, 'd ': 1, ' f': 1, 'fr': 1, 'ro': 1, 'om': 1,
        'm ': 1, ' h': 1, 'tt': 1, 'tp': 1, 'p:': 1, ':/': 1, '//': 1, '/s': 1,
        'sh': 1, 'ak': 1, 'ke': 1, 'es': 1, 'sp': 1, 'pe': 1, 'ea': 1, 'ar': 1,
        're': 1, 'e.': 1, '.m': 1, 'mi': 1, 'it': 1, '.e': 1, 'du': 1, 'u/': 1,
        '/h': 1, 't/': 1, '/f': 1, 'fu': 1, 'ul': 1, 'll': 1, 'l.': 1, '.h': 1,
        'tm': 1}


def test_empty_file(fixture_empty_txt):
    index = indexer.FileIndexer(fixture_empty_txt)
    index.read()

    assert index.get_index() == {}


def test_no_file_raises():
    with pytest.raises(TypeError):
        indexer.FileIndexer()


def test_multiline_file(fixture_hamlet_txt):
    index = indexer.FileIndexer(fixture_hamlet_txt)
    index.read()

    assert index.get_index() == {
        'e ': 4082, ' t': 3552, 'th': 3456, 'he': 2829, 't ': 2827, 's ': 2593,
        ', ': 2297, ' a': 2254, 'd ': 2143, 'ou': 1921, ' s': 1864, 'er': 1843,
        'in': 1753, ' m': 1740, ' h': 1700, 'an': 1613, ' w': 1544, 'nd': 1521,
        'r ': 1512, 'y ': 1500, 'n ': 1391, ' i': 1391, 're': 1385, 'at': 1370,
        'ha': 1348, ' o': 1340, 'or': 1319, 'is': 1287, 'o ': 1267, 'hi': 1212,
        'en': 1150, ' b': 1143, 'it': 1118, 'on': 1044, 'st': 1036, 'ea': 1000,
        'es': 996, ' f': 994, 'll': 988, '.\n': 971, 'ar': 969, 've': 931,
        ',\n': 911, ' d': 897, ' l': 894, 'to': 891, 'me': 891, 'se': 880,
        'f ': 842, ' c': 819, ' y': 818, 'no': 808, 'ur': 790, 'yo': 787,
        'ng': 775, ' n': 769, 'l ': 755, 'le': 749, 'h ': 748, 'of': 719,
        'te': 716, ' p': 706, 'ho': 702, 'ow': 675, 'lo': 670, '\nH': 669,
        'nt': 650, 'as': 647, 'ot': 626, 'al': 615, 'el': 593, '\nT': 593,
        'ee': 576, 'wi': 572, 'et': 569, 'ma': 563, 'ne': 560, 'ti': 552,
        'be': 549, 'de': 549, 'e,': 536, 'ed': 530, '\nA': 520, ' g': 519,
        'om': 515, 'ut': 511, 'I ': 505, 'u ': 493, 'co': 491, 'ro': 487,
        'Th': 482, 'us': 473, 'ra': 470, 'my': 460, ' I': 456, 'so': 453,
        'il': 453, 'ce': 452, 'ch': 449, 'rd': 446, 'li': 444, 'a ': 438,
        'sh': 436, 'ay': 429, 'we': 421, 'ri': 419, 'fo': 417, 's,': 415,
        'la': 408, 'rs': 408, 'oo': 403, 'rt': 395, 'ir': 389, ' e': 389,
        'HA': 387, 'AM': 387, 'ML': 387, 'LE': 387, 'ET': 387, 'm ': 384,
        '\nW': 380, 't,': 377, 'wh': 376, 'av': 372, 'T\n': 370, 'mo': 369,
        'ul': 369, 'im': 367, 'd,': 365, 'g ': 356, ' r': 355, 'un': 354,
        'do': 349, '\nI': 348, 'ld': 345, 'ad': 337, 'ke': 332, 'si': 330,
        ': ': 327, 'ai': 326, 'os': 325, 'ie': 325, 'io': 325, 'gh': 319,
        '; ': 318, 'S\n': 317, '?\n': 315, 'pe': 315, '. ': 307, 'w ': 307,
        'ge': 305, 'am': 299, 'nc': 298, ' u': 288, 'ta': 283, 'An': 282,
        'US': 280, 'em': 279, 'ns': 272, 'ss': 272, '\nO': 268, 'di': 268,
        'Wh': 266, 'wa': 265, 'ca': 263, 'k ': 263, ';\n': 262, 'wo': 262,
        'y,': 261, 'tr': 261, 'ic': 259, ' k': 258, 'od': 257, 'fa': 257,
        "'s": 254, 'ol': 254, 'ak': 247, 'e.': 241, 'ht': 241, 'e\n': 241,
        'po': 238, 'IU': 238, 'ac': 236, 'fe': 234, 'ER': 233, '\nL': 231,
        'ig': 231, 'OR': 227, 'EN': 225, 'bu': 225, 'ts': 223, 'pr': 222,
        'ec': 216, 'RA': 214, 'n,': 212, '\n\n': 210, 'go': 207, 'pa': 205,
        'UD': 202, 'sa': 200, 'LO': 199, ' C': 197, ':\n': 196, 'ly': 195,
        'id': 195, 't\n': 194, 'ry': 193, '\nS': 192, 'ds': 192, 'LA': 192,
        'iv': 190, 'sp': 188, 'bl': 188, 'mi': 187, ' G': 187, '\nB': 185,
        ' H': 185, '\nM': 182, "'d": 180, 'r,': 180, 's\n': 180, '!\n': 176,
        ' v': 175, 'ey': 174, ' P': 173, 'wn': 171, 'su': 170, 'hy': 168,
        'O\n': 165, 'if': 165, 'RT': 163, '\nE': 162, 'd.': 162, 'pl': 161,
        'ag': 161, 'ue': 161, '\nF': 160, 'ni': 160, 'tu': 160, 'ck': 159,
        'ev': 159, 'ov': 158, 'ki': 156, 'fr': 156, 'uc': 154, "'t": 154,
        'gr': 154, 'fi': 153, 'ei': 153, 'ct': 152, 'n\n': 151, 'bo': 148,
        'vi': 147, 't.': 146, 'ty': 145, 'ug': 145, 'na': 144, 'ye': 144,
        'mu': 143, 'TI': 142, 'tt': 141, 'To': 139, 'br': 139, 'ga': 138,
        '--': 136, 'DE': 136, 'rr': 135, 'IN': 135, 'ru': 133, 'ep': 133,
        'nk': 130, 'Ha': 130, '\nN': 128, 'HO': 128, 'AT': 127, 'IO': 127,
        'kn': 127, 'da': 127, " '": 126, 'l,': 126, 's.': 126, 'TE': 126,
        'qu': 123, '\nG': 123, 'No': 122, 'ap': 122, 'o,': 122, 'KI': 120,
        'NG': 120, 'G ': 120, 'CL': 120, 'AU': 120, 'DI': 120, 'tl': 119,
        'OL': 119, 'e;': 116, '! ': 116, 'r.': 114, 'PO': 113, 'ON': 113,
        'NI': 113, 'h,': 112, 'EL': 112, 'ef': 111, 'RD': 111, 'Bu': 111,
        'pi': 110, 'ff': 110, '? ': 109, 'd\n': 109, 'gi': 107, '\nK': 107,
        'up': 106, 'by': 106, 'ik': 105, 'au': 105, 'dr': 103, 'lf': 102,
        'rn': 102, 'Ho': 102, 'aw': 102, 'ls': 101, 'n.': 101, 'mp': 100,
        '\nR': 99, 'hu': 98, 'ia': 98, 'cr': 98, 'OS': 98, 'rm': 96, 'p ': 96,
        'ba': 95, 'Fo': 94, "n'": 94, 'ab': 94, 'e:': 93, "e'": 93, 'r\n': 89,
        'y.': 89, 'D ': 89, 'op': 88, 'oi': 88, "r'": 87, 'AN': 86, 'As': 86,
        ' q': 85, 'NC': 84, 'RN': 84, 'ml': 84, 'u,': 84, '\nt': 84, 'En': 83,
        'He': 83, 'ui': 83, 'Ex': 83, 'Wi': 83, 'Go': 83, 'cl': 83, 'sc': 82,
        'cu': 82, 'nn': 82, 'pu': 82, 'QU': 82, 'UE': 82, 'EE': 82, 'N ': 82,
        'GE': 82, 'TR': 82, 'RU': 82, 'ew': 80, 'ok': 80, ' O': 80, 'sw': 79,
        'mb': 79, 'A ': 78, 'e?': 78, "'l": 78, "' ": 78, 'um': 77, '-\n': 77,
        '\nY': 76, 'tw': 76, 'rc': 76, 't:': 76, 'hr': 76, 's:': 75, 'ft': 75,
        'Yo': 74, 'ms': 74, 'ci': 73, '\nD': 73, 'g,': 73, 'My': 73, 'gu': 72,
        '\nQ': 72, ' L': 72, 'AE': 72, 'ES': 72, 'LI': 72, 'ud': 72, 'dy': 72,
        'O,': 71, 'E\n': 71, 'ws': 70, 'd;': 70, '\nC': 69, 'IA': 69, 'LD': 69,
        'RO': 69, 'SE': 69, 'CR': 69, 'NT': 69, 'TZ': 69, 'fu': 68, "\n'": 68,
        'pp': 68, 's;': 68, 'lt': 67, 'ex': 67, 'OP': 67, 'PH': 67, 'HE': 67,
        'CE': 66, "o'": 66, 'oe': 66, 'm,': 66, 'AR': 65, 'w,': 65, 'oc': 65,
        ' j': 64, 'rk': 63, "I'": 63, 'A\n': 63, 't;': 62, ' T': 62, 'y\n': 61,
        'ob': 61, 'ks': 60, 'rg': 60, 'We': 59, 'fl': 59, 'It': 58, 'gl': 58,
        'ys': 57, "'e": 57, 'ph': 57, 'e!': 57, 'rl': 56, 'So': 56, 'gs': 56,
        'l.': 56, ' F': 55, 'Ma': 55, "t'": 55, 'sl': 55, 'Co': 55, 'af': 55,
        'Fi': 55, 'ST': 55, 'Be': 54, 'k,': 54, 'GU': 54, 'UI': 54, 'IL': 54,
        'NS': 54, 'O ': 53, 'vo': 53, 'mm': 53, 'd?': 52, 'In': 52, 'ny': 52,
        'tc': 51, 'm.': 51, '\nP': 51, 's?': 51, ' A': 50, 'eg': 50, 't?': 50,
        'du': 50, 'bi': 49, 'lu': 49, 'Le': 49, 'Cl': 49, ' W': 48, 'd:': 48,
        'N\n': 48, 'r:': 47, 'e-': 47, 'MA': 46, ' R': 46, 'eu': 46, 'Z\n': 46,
        'If': 45, ' D': 45, 'n;': 45, 'xe': 45, '\na': 45, 'pt': 44, 'ps': 44,
        'xi': 43, 'Of': 43, 'ub': 43, 'ip': 43, ' S': 42, 'LU': 42, 'La': 42,
        ',-': 42, "s'": 42, 'l\n': 42, 'va': 41, 'rv': 41, '\ns': 41, 'NA': 40,
        'DO': 40, 'Lo': 40, "'T": 40, 'RC': 40, 'LL': 40, 'r;': 40, 'Do': 40,
        'nf': 39, 'rp': 39, ' B': 38, 'wr': 38, 'Re': 38, '\nm': 38, 'ua': 37,
        'Si': 37, 'oa': 37, 'y;': 37, 'ae': 37, '\n[': 37, 'Ti': 36, 'je': 36,
        'h\n': 36, 'r?': 36, 'o\n': 36, ' M': 35, 'nm': 35, 'ib': 35, ' N': 35,
        'Ay': 35, '\ni': 35, "'\n": 34, 'f\n': 34, 'RI': 34, ' E': 33,
        'o.': 33, '\nU': 33, '\nc': 33, 'lv': 32, 'Or': 32, 'oy': 32, 't!': 32,
        '\nw': 31, 'De': 31, 'd!': 31, 'dn': 31, 'Is': 31, 'Al': 30, '\nh': 30,
        'Se': 30, '] ': 30, 'g.': 30, 'ju': 30, "l'": 30, 'n?': 30, 'sk': 30,
        'u.': 30, 'Pl': 29, 'SC': 29, 'dd': 29, 'f,': 29, 'm\n': 29, 'og': 29,
        'E ': 28, 'Fr': 28, 'n!': 28, 'l:': 28, 's!': 28, 'n:': 28, 'dg': 28,
        'SR': 28, 'IC': 28, 'Gi': 27, 'jo': 27, 'nv': 27, "i'": 27, 'C\n': 27,
        'g\n': 26, 'Mo': 26, 'bs': 26, 'gn': 26, 'cc': 26, 'eo': 26, 'xc': 26,
        'NE': 25, 'BE': 25, 'sy': 25, 'y?': 25, 'k.': 25, 'Na': 24, 'Di': 24,
        'sm': 24, 'h.': 24, 'Hi': 24, ' K': 24, 'dl': 24, 'gg': 24, 'Ge': 24,
        'lc': 23, 'Gh': 23, 'lk': 23, "k'": 23, 'Sh': 23, ' Q': 23, 'p,': 23,
        'a\n': 23, 'Pr': 23, 'Po': 22, 'ze': 22, "w'": 22, 'w\n': 22, 'S,': 22,
        'cy': 22, 'l;': 22, 'Ca': 22, '\ny': 22, 'o:': 21, 'aj': 21, 'y!': 21,
        'y:': 21, 'At': 21, 'rf': 21, 'r-': 21, 'lm': 21, 'xt': 21, 'Fa': 21,
        'rh': 21, '\nl': 21, 'Da': 20, 'nu': 20, 'rw': 20, 'eh': 20, 'Wo': 20,
        '-m': 20, 'Op': 20, 'uf': 20, '\nb': 20, '\np': 20, 'St': 19, 'o-': 19,
        'nb': 19, 'rb': 19, 'By': 19, 'mn': 19, 'a,': 19, '\ng': 19, '\nf': 19,
        'o?': 18, 'o!': 18, 'Sa': 18, 'g?': 18, 'g:': 18, 'S ': 18, '-a': 18,
        'On': 18, ",'": 18, '\nn': 18, 'I.': 17, '-n': 17, 'Ou': 17, 'Up': 17,
        'Ye': 17, ".'": 17, 'nl': 17, '\no': 17, 'f.': 16, 'ek': 16, "m'": 16,
        '-h': 16, "d'": 16, 'Ne': 16, 'Un': 16, 'w.': 16, 'eb': 16, ' V': 16,
        'eq': 16, 'yi': 16, 'o;': 16, 'n-': 16, 'lp': 16, 'm;': 16, ' Y': 16,
        'I\n': 15, 'h;': 15, 'Ro': 15, 'II': 15, 'bt': 15, 'yr': 15, 'a-': 15,
        'm:': 15, 'ya': 15, 'RE': 15, 'EY': 15, 'YN': 15, 'AL': 15, 'T ': 14,
        'CO': 14, 't-': 14, "g'": 14, 'hs': 14, 'u:': 14, 'Ar': 14, "h'": 14,
        'I,': 14, 'Sw': 14, 'Z ': 14, 'u?': 13, 'a!': 13, 'Qu': 13, 'k\n': 13,
        'k;': 13, 'g;': 13, "y'": 13, '-s': 13, 'Ta': 13, '-w': 13, 'h:': 13,
        'dm': 13, 'xp': 13, '\nd': 13, 'f;': 12, 'az': 12, 'iu': 12, 'Sp': 12,
        'w;': 12, '-d': 12, 'ix': 12, 'r!': 12, '\nV': 12, 'Li': 12, 'uo': 12,
        'kl': 12, 'gm': 12, 'sb': 12, 's-': 12, 'c ': 12, 'g-': 12, 'tf': 11,
        'CI': 11, '-l': 11, 'bb': 11, 'vy': 11, 'l-': 11, '-t': 11, 'l!': 11,
        '[A': 11, 'nw': 11, '\ne': 11, 'sd': 10, 'dv': 10, 'd-': 10, 'Mu': 10,
        'h-': 10, 'ax': 10, 'u;': 10, 'm?': 10, "a'": 10, 'k:': 10, 'Gu': 10,
        'u\n': 10, 'Py': 10, 'ku': 10, 'FR': 9, 'IS': 9, 'Su': 9, 'Wa': 9,
        'iz': 9, 'wl': 9, '-e': 9, 'b ': 9, 'E,': 9, 'e]': 9, 'w!': 9, 'Ev': 9,
        'Tw': 9, '-p': 9, '-b': 9, 'Ki': 9, 'Ad': 9, 'l?': 9, 'Me': 9, 'Ch': 9,
        'FO': 9, 'NB': 9, 'BR': 9, 'AS': 9, 'h?': 8, ' J': 8, 'ym': 8, 'Br': 8,
        'hl': 8, 'h!': 8, 'w?': 8, 'xa': 8, 'p.': 8, 'Gr': 8, 'Te': 8, 'y-': 8,
        'za': 8, 'Z,': 8, 'tz': 8, 'k?': 8, ']\n': 8, 'Tr': 8, '\nk': 8,
        's]': 8, 'El': 7, 'k!': 7, 'nh': 7, "'g": 7, 'p;': 7, 'df': 7, 'Pa': 7,
        'm!': 7, 'w:': 7, 'np': 7, 'ah': 7, ':-': 7, 'w-': 7, 'gt': 7, 'Ve': 7,
        'iq': 7, 'hm': 7, "u'": 7, "'A": 7, '[W': 7, 'n]': 7, "'F": 7, 'sn': 7,
        '-f': 7, '-c': 7, '[S': 7, 'Pe': 6, 'f:': 6, '.-': 6, 'VO': 6, 'LT': 6,
        'IM': 6, 'ND': 6, "x'": 6, '!-': 6, 'tn': 6, 'tm': 6, 'wd': 6, '  ': 6,
        'lr': 6, '[B': 6, "'I": 6, 'c.': 6, 'Pu': 6, 'nj': 6, '\nr': 6,
        'p:': 6, 'x ': 6, 'PR': 6, 'AC': 5, 'CT': 5, 'g!': 5, "p'": 5, 'bj': 5,
        'nq': 5, 'gd': 5, 'Im': 5, 'Vi': 5, '-o': 5, 'zz': 5, 'Fe': 5, "f'": 5,
        'V.': 5, 'ja': 5, 'ko': 5, 'u!': 5, "'m": 5, "'n": 5, ":'": 5, 'Dr': 5,
        '-g': 5, 'cs': 5, 'z ': 5, 'sf': 5, 'Bo': 5, 'Mi': 5, ' &': 5, '& ': 5,
        'b,': 5, 'py': 5, 'Am': 5, 'Ab': 5, 'oz': 5, 'p?': 5, 'Ea': 5, 'pw': 4,
        'Ag': 4, 'vu': 4, 'T,': 4, '-r': 4, 'ky': 4, 'f-': 4, 'Hy': 4, 'yp': 4,
        'Af': 4, 'IV': 4, 'Sl': 4, "O'": 4, 'h]': 4, 'Ah': 4, "'W": 4, 'yn': 4,
        'N,': 4, 'hn': 4, "'-": 4, 'hf': 4, '-I': 4, "'S": 4, 'uz': 4, 'sr': 4,
        'Ba': 4, 'nz': 4, 'a:': 4, 'hd': 4, 'Ri': 4, 'ox': 4, 'x,': 4,
        '\nv': 4, "'H": 4, 'Os': 4, 'm-': 3, 'Ju': 3, 'Aw': 3, 'cq': 3,
        'lg': 3, 'Er': 3, 'nr': 3, 'p-': 3, 'uy': 3, 'oh': 3, '-y': 3, 'f?': 3,
        'ez': 3, 'Ra': 3, 'lw': 3, 'Cu': 3, "'f": 3, "'G": 3, "'O": 3, 'T.': 3,
        '\nq': 3, "'?": 3, 'fs': 3, 'Je': 3, "'r": 3, 'Bl': 3, "!'": 3,
        'ji': 3, "?'": 3, 'Jo': 3, 'A,': 3, 'fy': 3, 'g]': 3, 'Cr': 3,
        'c\n': 3, 'Sc': 3, "E'": 3, 'Tu': 2, 'I;': 2, 'sq': 2, 'Vo': 2,
        'D\n': 2, 'ej': 2, 'mf': 2, 'Ni': 2, 'p!': 2, 'zl': 2, 'mr': 2,
        'Ru': 2, 'dc': 2, 'Rh': 2, 'Pi': 2, 'zo': 2, 'hc': 2, '-v': 2, 'Wr': 2,
        "S'": 2, 'tb': 2, 'Ac': 2, "'c": 2, 'Ob': 2, 'gy': 2, 'yv': 2, 'hb': 2,
        'Hu': 2, 'uk': 2, "'L": 2, 'b\n': 2, '[T': 2, 'S]': 2, 'z!': 2,
        'Sb': 2, '\nu': 2, '-i': 2, 'Ol': 2, 'p\n': 2, 'a.': 2, 'I!': 2,
        'b;': 2, '-S': 2, 'k-': 2, 'b-': 2, 'u-': 2, 'mw': 2, 'UC': 2, 'NU': 2,
        'c!': 2, 'c,': 2, '[R': 2, 'd]': 2, 'Ov': 2, 'V\n': 2, ";'": 2,
        "'i": 2, 'Va': 2, 'VI': 2, "'N": 2, "'a": 2, "'v": 2, 'dt': 2, '-O': 2,
        'ln': 1, 'D,': 1, 'sj': 1, "'h": 1, '-F': 1, 'Ap': 1, 'Oc': 1, 'a;': 1,
        'Ke': 1, 'ka': 1, 'wt': 1, ' U': 1, 'GH': 1, 'ux': 1, 'xu': 1, 'dw': 1,
        'mt': 1, 'dh': 1, 'z:': 1, 'pf': 1, 'yf': 1, "'b": 1, "'D": 1, '[P': 1,
        'r]': 1, '-H': 1, 'kw': 1, '-M': 1, 'fp': 1, 'N]': 1, '-q': 1, 'Fl': 1,
        'wk': 1, 'z,': 1, 'Ae': 1, 'Il': 1, 'Cy': 1, 'yc': 1, "'B": 1, "-'": 1,
        "'R": 1, 'Ga': 1, 'yk': 1, 'Us': 1, 'wf': 1, 'dk': 1, 'Ny': 1, 'iw': 1,
        'Bi': 1, 'Vu': 1, 'Ly': 1, "A'": 1, 'I?': 1, 'Fu': 1, 'Ph': 1, 'Lu': 1,
        '- ': 1, 'oq': 1, 'hw': 1, 'dj': 1, 'xm': 1, 'wb': 1, '[D': 1, 'x?': 1,
        '-k': 1, 'Ey': 1, 'tp': 1, 'Ec': 1, 'c:': 1, ' [': 1, '[ ': 1, ' ]': 1,
        'Z:': 1, 'N:': 1, 'zi': 1, 'zv': 1, 'xh': 1, "'C": 1, 'Kn': 1, '?-': 1,
        'i-': 1, "'w": 1, 'oj': 1, 'Ya': 1, 'mv': 1, 'wy': 1, 'x;': 1, 'a?': 1,
        'bh': 1, 'ih': 1, 'wm': 1, 'f!': 1, 'I:': 1, ' z': 1, 'lb': 1, 'zy': 1,
        'C,': 1, "T'": 1, '\nJ': 1, 'pk': 1, 'T;': 1, 'c;': 1}
